name: Make CI

on: [push]

defaults:
  runs-on: ubuntu-latest
  run:
    working-directory: src

jobs:
  Compile:

    strategy:
      matrix:
        cc: [gcc, clang]

    steps:
    - uses: actions/checkout@v1

    - name: Basic
      run: make CC=${{ matrix.cc }} basic

    - name: Releases
      run: make CC=${{ matrix.cc }} release

    - name: PGO
      if: matrix.cc == 'gcc'
      run: make CC=${{ matrix.cc }} pgo

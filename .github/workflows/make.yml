name: Make CI

on: [push]

defaults:
  run:
    working-directory: src

jobs:
  Compile:

    runs-on: ubuntu-latest
    strategy:
      matrix:
        cc: [gcc, clang]

    steps:
    - uses: actions/checkout@v1
    - name: Basic
      run: make basic CC=${{ matrix.cc }}
    - name: Releases
      run: make release CC=${{ matrix.cc }}
    - name: PGO
      if: ${{ matrix.cc == 'gcc' }}
      run: make pgo CC=${{ matrix.cc }}
